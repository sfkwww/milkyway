name: CI
on:
  pull_request:
    types:
      - labeled
    branches: [ main ]

jobs:
  check-repo-activity-for-pr:
    if: github.event.label.name == 'contribution_to_opensource'
    runs-on: ubuntu-latest
    name: PR activity check
    steps:
    - name: Run index
      id: index
      uses: sfkwww/milkyway@v0.3
      with:
        github_token: ${{ secrets.TOKEN }}
        pr_body: ${{ github.event.pull_request.body }}
        pr_id: ${{ github.event.pull_request.number }}
        repo: ${{ github.repository }}
    - name: Comment the results
      uses: actions/github-script@v3
      with:
        github-token: ${{secrets.TOKEN}}
        script: |
          github.issues.createComment({
            issue_number: context.pull_request.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: `ðŸ‘‹ Thanks for reporting! ${context.workflow.steps.index.output.repo}`
          })
